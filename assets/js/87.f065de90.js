(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{350:function(n,a,e){"use strict";e.r(a);var s=e(13),t=Object(s.a)({},(function(){var n=this,a=n._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h1",{attrs:{id:"小程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序"}},[n._v("#")]),n._v(" 小程序")]),n._v(" "),a("h2",{attrs:{id:"基础知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础知识"}},[n._v("#")]),n._v(" 基础知识")]),n._v(" "),a("p",[n._v("携带参数跳转\n使用data-你的参数   来传递函数的变量，然后从event.crrrentTarget.dataset中获取对应的变量，\ndata绑定的变量驼峰模式的要把大写变成\"-\"\nwx.navigateTo可以携带参数，比如在url中写 'camp?id=2'，在对应的具体页面通过onLoad传递的option获取传递过来的参数\n如果要传递参数是一个对象，你可以使用JSON.stringify()转化拼接在路径上，或者在新页面中从globalData中获取")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('    <block wx:for="{{campList}}" wx:key="{{item.name}}">\n      <view class="more-item" data-id="{{item.id}}" bindtap="toCampDetail">\n        <view class="img-area">\n          <image src="{{item.imgUrl}}"></image>\n        </view>\n        <view class="more-camp-right">\n          <view class="more-camp-name">\n            {{item.name}}\n            <van-tag color="{{item.color}}">{{item.type}}</van-tag>\n          </view>\n          <view class="camp-value">\n            <view>距离{{item.distance}}公里</view>\n            <view>共有{{item.campNum}}个营位</view>\n            <view class="price">￥{{item.price}}</view>\n          </view>\n        </view>\n      </view>\n    </block>\n// js代码\n  toCampDetail(event) {\n    console.log(event.currentTarget.dataset.id);\n  },\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br")])]),a("h2",{attrs:{id:"登录相关逻辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录相关逻辑"}},[n._v("#")]),n._v(" 登录相关逻辑")]),n._v(" "),a("p",[a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("获取手机号"),a("OutboundLink")],1)]),n._v(" "),a("h2",{attrs:{id:"获取当前城市定位"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取当前城市定位"}},[n._v("#")]),n._v(" 获取当前城市定位")]),n._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/weixin_42262436/article/details/80458430",target:"_blank",rel:"noopener noreferrer"}},[n._v("微信小程序获取当前用户定位"),a("OutboundLink")],1),n._v(" "),a("a",{attrs:{href:"https://lbs.qq.com/qqmap_wx_jssdk/index.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("微信小程序原生LBS能力的最佳拍档"),a("OutboundLink")],1)]),n._v(" "),a("p",[n._v("满屏显示： width：100%; height: 100vh;")]),n._v(" "),a("h2",{attrs:{id:"登录并实现登录状态维持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录并实现登录状态维持"}},[n._v("#")]),n._v(" 登录并实现登录状态维持")]),n._v(" "),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/c5f6c98b2685",target:"_blank",rel:"noopener noreferrer"}},[n._v("微信小程序中用户登录和登录态维护"),a("OutboundLink")],1),n._v(" "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/login/auth.code2Session.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("服务端登录获取session_key"),a("OutboundLink")],1)]),n._v(" "),a("h2",{attrs:{id:"获取unionid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取unionid"}},[n._v("#")]),n._v(" 获取unionid")]),n._v(" "),a("p",[n._v("公众平台的账号需要绑定开放平台的应用才能获取unionid\n或者采用服务端解密可以获取私密数据\n"),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html#%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95",target:"_blank",rel:"noopener noreferrer"}},[n._v("服务端获取开放数据"),a("OutboundLink")],1)]),n._v(" "),a("h2",{attrs:{id:"监测用户授权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#监测用户授权"}},[n._v("#")]),n._v(" 监测用户授权")]),n._v(" "),a("h2",{attrs:{id:"页面分享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#页面分享"}},[n._v("#")]),n._v(" 页面分享")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("onShareAppMessage: function( options ){\n　　// 自定义分享内容\n　　var shareObj = {\n　　　　title: \"转发的标题\",        // 小程序的名称\n　　　　path: '/pages/share/share',        // 默认是当前页面，必须是以‘/’开头的完整路径\n　　　　imgUrl: '',     //自定义图片路径，支持PNG及JPG，不传入 imageUrl 则使用默认截图。显示图片长宽比是 5:4\n　　　　success: function(res){\n　　　　　　// 转发成功之后的回调\n　　　　　　if(res.errMsg == 'shareAppMessage:ok'){\n　　　　　　}\n　　　　},\n　　　　fail: function(){\n　　　　　　// 转发失败之后的回调\n　　　　　　if(res.errMsg == 'shareAppMessage:fail cancel'){\n　　　　　　　　// 用户取消转发\n　　　　　　}else if(res.errMsg == 'shareAppMessage:fail'){\n　　　　　　　　// 转发失败，其中 detail message 为详细失败信息\n　　　　　　}\n　　　　},\n　　　　complete: fucntion(){\n　　　　　　// 转发结束之后的回调（转发成不成功都会执行）\n　　　　}\n　　};\n　　// 来自页面内的按钮的转发\n　　if( options.from == 'button' ){\n　　　　console.log(\"来源于button\");\n　　　　// 此处可以修改 shareObj 中的内容\n　　　　shareObj.path = '/pages/btnname/btnname?btn_name='+eData.name;\n　　}\n　　// 返回shareObj\n　　return shareObj;\n}\n\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br")])]),a("p",[n._v("使用按钮转发：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<button open-type="share">转发</button>\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[n._v("嵌套图片转发，引用网络图片：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('      <button\n        class="share-btn"\n        open-type="share">\n      </button>\n// 样式\n\n.share-btn{\n  opacity: 1;\n  width: 48rpx;\n  height: 48rpx;\n  border: none;\n  background: url(\'http://qiniu.rvties.com/FqiM0gPSh0qjnUnkGzura9g8r1Hz\') center center;\n  background-repeat:no-repeat;\n  background-size: 48rpx 48rpx;\n  margin: auto;\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br")])]),a("h2",{attrs:{id:"微信支付"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微信支付"}},[n._v("#")]),n._v(" 微信支付")]),n._v(" "),a("ol",[a("li",[n._v("通过登录得到code，服务端用code换取用户的openid")]),n._v(" "),a("li",[n._v("生成预定订单号，为了获取prepay_id，需要向"),a("a",{attrs:{href:"https://api.mch.weixin.qq.com/pay/unifiedorder",target:"_blank",rel:"noopener noreferrer"}},[n._v("统一下单接口"),a("OutboundLink")],1),n._v("请求，然后吧prepay_id返回给小程序")]),n._v(" "),a("li",[n._v("小程序拿到prepay_id调用支付接口wx.requestPayment发起支付")]),n._v(" "),a("li",[n._v("成功or失败的跳转到商户小程序的页面")]),n._v(" "),a("li",[n._v("更新商品数据和记录用户订单情况\n"),a("a",{attrs:{href:"https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=9_1&index=1",target:"_blank",rel:"noopener noreferrer"}},[n._v("统一下单-API"),a("OutboundLink")],1),n._v(" "),a("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1037348",target:"_blank",rel:"noopener noreferrer"}},[n._v("干货|必看！从零接入微信小程序支付"),a("OutboundLink")],1),n._v(" "),a("a",{attrs:{href:"https://www.cnblogs.com/catcher1994/p/6664404.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("微信小程序支付简单小结与梳理"),a("OutboundLink")],1)])]),n._v(" "),a("p",[n._v("开发用到： xmlreader\n商户平台下载API安全证书\njs-sdk")]),n._v(" "),a("p",[n._v("主要问题：")]),n._v(" "),a("ul",[a("li",[n._v("签名参数错误")]),n._v(" "),a("li",[n._v("签名的Key错误")])])])}),[],!1,null,null,null);a.default=t.exports}}]);